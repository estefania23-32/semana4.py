. Registro y consulta de ventas
‚Ä¢ Permitir registrar ventas de productos, asociando: cliente, producto vendido,
cantidad, fecha y descuento (si aplica).
‚Ä¢ Validar stock disponible y actualizarlo autom√°ticamente.# National Library Management System - Simple Version

class NationalLibrary:
    def __init__(self):
        self.books = []
        self.id_counter = 1
    
    def add_book(self, title, author, price, stock):
        book = {
            'id': self.id_counter,
            'title': title,
            'author': author,
            'price': price,
            'original_price': price,
            'stock': stock,
            'sales': 0,
            'discount': 0
        }
        self.books.append(book)
        self.id_counter += 1
        print(f"‚úÖ Libro '{title}' agregado exitosamente")
    
    def show_books(self):
        if not self.books:
            print("üìö No hay libros en la biblioteca")
            return
        
        print("\nüìö CAT√ÅLOGO DE LA BIBLIOTECA NACIONAL")
        print("-" * 60)
        for book in self.books:
            price_display = f"${book['price']:.2f}"
            if book['discount'] > 0:
                price_display += f" (desc. {book['discount']}%)"
            
            print(f"ID: {book['id']} | {book['title']} - {book['author']}")
            print(f"    Precio: {price_display} | Stock: {book['stock']} | Ventas: {book['sales']}")
            print("-" * 60)
    
    def sell_book(self, book_id, quantity=1):
        book = next((b for b in self.books if b['id'] == book_id), None)
        if not book:
            print("‚ùå Libro no encontrado")
            return
        
        if book['stock'] < quantity:
            print(f"‚ùå Stock insuficiente. Solo quedan {book['stock']} unidades")
            return
        
        book['stock'] -= quantity
        book['sales'] += quantity
        print(f"‚úÖ Venta realizada: {quantity} unidad(es) de '{book['title']}'")
    
    def apply_discount(self, book_id, percentage):
        book = next((b for b in self.books if b['id'] == book_id), None)
        if not book:
            print("‚ùå Libro no encontrado")
            return
        
        if percentage < 0 or percentage > 100:
            print("‚ùå El descuento debe estar entre 0% y 100%")
            return
        
        book['discount'] = percentage
        book['price'] = book['original_price'] * (1 - percentage / 100)
        print(f"‚úÖ Descuento del {percentage}% aplicado a '{book['title']}'")

# Create library instance
library = NationalLibrary()

# Lambda functions for specific operations
search_by_author = lambda author: [b for b in library.books if author.lower() in b['author'].lower()]
search_by_title = lambda title: [b for b in library.books if title.lower() in b['title'].lower()]
available_books = lambda: [b for b in library.books if b['stock'] > 0]
best_sellers = lambda: sorted(library.books, key=lambda x: x['sales'], reverse=True)[:3]
books_with_discount = lambda: [b for b in library.books if b['discount'] > 0]
books_without_discount = lambda: [b for b in library.books if b['discount'] == 0]

def show_results(books, title="Resultados"):
    print(f"\nüîç {title}")
    print("-" * 50)
    if not books:
        print("No se encontraron libros")
        return
    
    for book in books:
        price_display = f"${book['price']:.2f}"
        if book['discount'] > 0:
            price_display += f" (desc. {book['discount']}%)"
        
        print(f"{book['title']} - {book['author']}")
        print(f"Precio: {price_display} | Stock: {book['stock']} | Ventas: {book['sales']}")
        print("-" * 50)

def add_initial_books():
    print("üèõÔ∏è  Biblioteca Nacional - Sistema de Gesti√≥n")
    print("üìö Agregar 5 libros iniciales")
    print("=" * 50)
    
    for i in range(1, 6):
        print(f"\nüìñ Libro {i}/5:")
        try:
            title = input("  T√≠tulo: ")
            author = input("  Autor: ")
            price = float(input("  Precio: $"))
            stock = int(input("  Stock: "))
            library.add_book(title, author, price, stock)
        except ValueError:
            print("  ‚ùå Error en los datos. Intenta de nuevo.")
            i -= 1
    
    print("\nüéâ ¬°Cat√°logo inicial completado!\n")

def main_menu():
    while True:
        print("\nüèõÔ∏è  BIBLIOTECA NACIONAL")
        print("=" * 40)
        print("1. Agregar libro")
        print("2. Mostrar cat√°logo")
        print("3. Buscar por autor")
        print("4. Buscar por t√≠tulo")
        print("5. Libros disponibles")
        print("6. üèÜ Los 3 m√°s vendidos")
        print("7. Vender libro")
        print("8. Aplicar descuento")
        print("9. Libros con descuento")
        print("0. Salir")
        print("=" * 40)
        
        try:
            option = int(input("Selecciona una opci√≥n: "))
            
            if option == 1:
                title = input("T√≠tulo: ")
                author = input("Autor: ")
                price = float(input("Precio: $"))
                stock = int(input("Stock: "))
                library.add_book(title, author, price, stock)
            
            elif option == 2:
                library.show_books()
            
            elif option == 3:
                author = input("Autor: ")
                results = search_by_author(author)
                show_results(results, f"Libros de {author}")
            
            elif option == 4:
                title = input("T√≠tulo: ")
                results = search_by_title(title)
                show_results(results, f"Libros con '{title}'")
            
            elif option == 5:
                available = available_books()
                show_results(available, "Libros Disponibles")
            
            elif option == 6:
                top_sellers = best_sellers()
                show_results(top_sellers, "üèÜ Los 3 Libros M√°s Vendidos")
            
            elif option == 7:
                library.show_books()
                book_id = int(input("ID del libro: "))
                quantity = int(input("Cantidad (default 1): ") or "1")
                library.sell_book(book_id, quantity)
            
            elif option == 8:
                no_discount = books_without_discount()
                if not no_discount:
                    print("‚ùå Todos los libros tienen descuento")
                else:
                    show_results(no_discount, "Libros para descuento")
                    book_id = int(input("ID del libro: "))
                    percentage = float(input("Porcentaje de descuento: "))
                    library.apply_discount(book_id, percentage)
            
            elif option == 9:
                with_discount = books_with_discount()
                show_results(with_discount, "üí∞ Libros con Descuento")
            
            elif option == 0:
                print("¬°Gracias por usar la Biblioteca Nacional! üìö")
                break
            
            else:
                print("‚ùå Opci√≥n inv√°lida")
                
        except ValueError:
            print("‚ùå Error: Ingresa un n√∫mero v√°lido")
        except Exception as e:
            print(f"‚ùå Error: {e}")

# Load example data
def load_example_data():
    books_data = [
        ("Cien a√±os de soledad", "Gabriel Garc√≠a M√°rquez", 25.99, 15),
        ("El Quijote", "Miguel de Cervantes", 30.50, 8),
        ("Pedro P√°ramo", "Juan Rulfo", 16.80, 20),
        ("Rayuela", "Julio Cort√°zar", 27.30, 4),
        ("El Aleph", "Jorge Luis Borges", 19.99, 10)
    ]
    
    print("üìö Cargando datos de ejemplo...")
    for title, author, price, stock in books_data:
        library.add_book(title, author, price, stock)
    
    # Simulate some sales
    library.sell_book(1, 5)  # Cien a√±os de soledad
    library.sell_book(2, 3)  # El Quijote  
    library.sell_book(3, 8)  # Pedro P√°ramo
    library.sell_book(1, 2)  # More sales
    
    # Apply discounts
    library.apply_discount(4, 15)  # Rayuela
    library.apply_discount(5, 10)  # El Aleph
    
    print("‚úÖ Datos cargados exitosamente\n")

# Run program
if __name__ == "__main__":
    print("üèõÔ∏è  Bienvenido a la Biblioteca Nacional")
    choice = input("¬øCargar datos de ejemplo? (s/n): ").lower()
    
    if choice == 's':
        load_example_data()
    else:
        add_initial_books()
    
    main_menu()
